# 数据交换格式
## CSV数据交换格式
### reader（）函数


```python
import csv

with open('data/books.csv', 'r',  encoding='gbk') as rf:
    reader = csv.reader(rf, dialect=csv.excel)
    for row in reader:
        print('|'.join(row))
```

    1|软件工程|戴国强|机械工业出版社|19980528|2
    2|汇编语言|李利光|北京大学出版社|19980318|2
    3|计算机基础|王飞|经济科学出版社|19980218|1
    4|FLASH精选|刘扬|中国纺织出版社|19990312|2
    5|java基础|王一|电子工业出版社|19990528|3
    6|世界杯|柳飞|世界出版社|19990412|2
    7|JAVA程序设计|张余|人民邮电出版社|19990613|1
    8|新概念3|余智|外语出版社|19990723|2
    9|军事要闻|张强|解放军出版社|19990722|3
    10|大众生活|许阳|电子出版社|19990819|3
    11|南方旅游|王爱国|南方出版社|19990930|2
    13|幽灵|钱力华|华光出版社|19991008|1
    14|期货分析|孙宝|飞鸟出版社|19991122|3
    15|人工智能|周未|机械工业出版社|19991223|3
    16|数据库系统概念|吴红|机械工业出版社|20000328|3
    17|计算机理论基础|戴家|机械工业出版社|20000218|4
    18|编译原理|郑键|机械工业出版社|20000415|2
    19|通讯与网络|欧阳杰|机械工业出版社|20000517|1
    20|现代操作系统|王小国|机械工业出版社|20010128|1
    21|网络基础|王大尉|北京大学出版社|20000617|1
    22|万紫千红|丛丽|北京大学出版社|20000702|3
    23|经济概论|思佳|北京大学出版社|20000819|3
    24|经济与科学|毛波|经济科学出版社|20000923|2
    25|计算机体系结构|方丹|机械工业出版社|20000328|4
    26|软件工程|牛田|经济科学出版社|20000328|4
    27|世界语言大观|候丙辉|经济科学出版社|20000814|2
    28|高级语言程序设计|寇国华|清华大学出版社|20000117|3
    29|操作系统概论|聂元名|清华大学出版社|20001028|1
    30|数据库及应用|孙家萧|清华大学出版社|20000619|1
    31|软件工程|戴志名|电子工业出版社|20000324|3
    32|SOL使用手册|贺民|电子工业出版社|19990425|2
    33|模拟电路|邓英才|电子工业出版社|20000527|2
    34|集邮爱好者|李云|人民邮电出版社|20000630|1
    36|高等数学|李放|人民邮电出版社|20000812|1
    37|南方周末|邓光明|南方出版社|20000923|3
    38|十大旅游胜地|潭晓明|南方出版社|20000403|2
    39|黑幕|李仪|华光出版社|20000508|24
    

### writer()函数


```python
import csv

with open('data/books.csv', 'r', encoding='gbk') as rf:
    reader = csv.reader(rf)
    with open('data/books2.csv', 'w', newline='', encoding='gbk') as wf:
        writer = csv.writer(wf, delimiter='\t')
        for row in reader:
            print('|'.join(row))
            writer.writerow(row)
```

    1|软件工程|戴国强|机械工业出版社|19980528|2
    2|汇编语言|李利光|北京大学出版社|19980318|2
    3|计算机基础|王飞|经济科学出版社|19980218|1
    4|FLASH精选|刘扬|中国纺织出版社|19990312|2
    5|java基础|王一|电子工业出版社|19990528|3
    6|世界杯|柳飞|世界出版社|19990412|2
    7|JAVA程序设计|张余|人民邮电出版社|19990613|1
    8|新概念3|余智|外语出版社|19990723|2
    9|军事要闻|张强|解放军出版社|19990722|3
    10|大众生活|许阳|电子出版社|19990819|3
    11|南方旅游|王爱国|南方出版社|19990930|2
    13|幽灵|钱力华|华光出版社|19991008|1
    14|期货分析|孙宝|飞鸟出版社|19991122|3
    15|人工智能|周未|机械工业出版社|19991223|3
    16|数据库系统概念|吴红|机械工业出版社|20000328|3
    17|计算机理论基础|戴家|机械工业出版社|20000218|4
    18|编译原理|郑键|机械工业出版社|20000415|2
    19|通讯与网络|欧阳杰|机械工业出版社|20000517|1
    20|现代操作系统|王小国|机械工业出版社|20010128|1
    21|网络基础|王大尉|北京大学出版社|20000617|1
    22|万紫千红|丛丽|北京大学出版社|20000702|3
    23|经济概论|思佳|北京大学出版社|20000819|3
    24|经济与科学|毛波|经济科学出版社|20000923|2
    25|计算机体系结构|方丹|机械工业出版社|20000328|4
    26|软件工程|牛田|经济科学出版社|20000328|4
    27|世界语言大观|候丙辉|经济科学出版社|20000814|2
    28|高级语言程序设计|寇国华|清华大学出版社|20000117|3
    29|操作系统概论|聂元名|清华大学出版社|20001028|1
    30|数据库及应用|孙家萧|清华大学出版社|20000619|1
    31|软件工程|戴志名|电子工业出版社|20000324|3
    32|SOL使用手册|贺民|电子工业出版社|19990425|2
    33|模拟电路|邓英才|电子工业出版社|20000527|2
    34|集邮爱好者|李云|人民邮电出版社|20000630|1
    36|高等数学|李放|人民邮电出版社|20000812|1
    37|南方周末|邓光明|南方出版社|20000923|3
    38|十大旅游胜地|潭晓明|南方出版社|20000403|2
    39|黑幕|李仪|华光出版社|20000508|24
    

## XML数据交换格式
### XML文档结构
1. 声明
2. 根元素
3. 子元素
4. 属性
5. 命名空间
6. 限定名

### 解析XML文档


```python
import xml.etree.ElementTree as ET

tree = ET.parse('data1/Notes.xml')  # 创建XML文档树
print(type(tree))  # xml.etree.ElementTree.ElementTree

root = tree.getroot()  # root是根元素
print(type(root))  # xml.etree.ElementTree.Element
print(root.tag)  # Notes

for index, child in enumerate(root):
    print('第{0}个{1}元素，属性：{2}'.format(index, child.tag, child.attrib))
    for i, child_child in enumerate(child):
        print('    标签：{0}，内容：{1}'.format(child_child.tag, child_child.text))
```

    <class 'xml.etree.ElementTree.ElementTree'>
    <class 'xml.etree.ElementTree.Element'>
    Notes
    第0个Note元素，属性：{'id': '1'}
        标签：CDate，内容：2018-3-21
        标签：Content，内容：发布Python0
        标签：UserID，内容：tony
    第1个Note元素，属性：{'id': '2'}
        标签：CDate，内容：2018-3-22
        标签：Content，内容：发布Python1
        标签：UserID，内容：tony
    第2个Note元素，属性：{'id': '3'}
        标签：CDate，内容：2018-3-23
        标签：Content，内容：发布Python2
        标签：UserID，内容：tony
    第3个Note元素，属性：{'id': '4'}
        标签：CDate，内容：2018-3-24
        标签：Content，内容：发布Python3
        标签：UserID，内容：tony
    第4个Note元素，属性：{'id': '5'}
        标签：CDate，内容：2018-3-25
        标签：Content，内容：发布Python4
        标签：UserID，内容：tony
    

### XPath
1. find(match,namespace=None)
2. findall(match,namespace=None)
3. findtext(match,default=None,namespace=None)


```python
import xml.etree.ElementTree as ET

tree = ET.parse('data1/Notes.xml')
root = tree.getroot()

node = root.find("./Note")  # 当前节点下的第一个Note子节点
print(node.tag, node.attrib)
node = root.find("./Note/CDate")  # Note子节点下的第一个CDate节点
print(node.text)
node = root.find("./Note/CDate/..")  # Note节点
print(node.tag, node.attrib)
node = root.find(".//CDate")  # 当前节点查找所有后代节点中第一个CDate节点
print(node.text)

node = root.find("./Note[@id]")  # 具有id属性Note节点
print(node.tag, node.attrib)

node = root.find("./Note[@id='2']")  # id属性等于'2'的Note节点
print(node.tag, node.attrib)

node = root.find("./Note[2]")  # 第二个Note节点
print(node.tag, node.attrib)

node = root.find("./Note[last()]")  # 最后一个Note节点
print(node.tag, node.attrib)

node = root.find("./Note[last()-2]")  # 倒数第三个Note节点
print(node.tag, node.attrib)
```

    Note {'id': '1'}
    2018-3-21
    Note {'id': '1'}
    2018-3-21
    Note {'id': '1'}
    Note {'id': '2'}
    Note {'id': '2'}
    Note {'id': '5'}
    Note {'id': '3'}
    

## JSON数据交换格式
### JSON文档结构
### JSON数据编码


```python
import json

# 准备数据
py_dict = {'name': 'tony', 'age': 30, 'sex': True}  # 创建字典对象
py_list = [1, 3]  # 创建列表对象
py_tuple = ('A', 'B', 'C')  # 创建元组对象

py_dict['a'] = py_list  # 添加列表到字典中
py_dict['b'] = py_tuple  # 添加元组到字典中

print(py_dict)
print(type(py_dict))  # <class 'dict'>

# 编码过程
json_obj = json.dumps(py_dict)
print(json_obj)
print(type(json_obj))  # <class 'str'>

# 编码过程
json_obj = json.dumps(py_dict, indent=4)
# 输出格式化后的字符串
print(json_obj)

# 写入JSON数据到data1.json文件
with open('data2/data1.json', 'w') as f:
    json.dump(py_dict, f)

# 写入JSON数据到data2.json文件
with open('data2/data2.json', 'w') as f:
    json.dump(py_dict, f, indent=4)
```

    {'name': 'tony', 'age': 30, 'sex': True, 'a': [1, 3], 'b': ('A', 'B', 'C')}
    <class 'dict'>
    {"name": "tony", "age": 30, "sex": true, "a": [1, 3], "b": ["A", "B", "C"]}
    <class 'str'>
    {
        "name": "tony",
        "age": 30,
        "sex": true,
        "a": [
            1,
            3
        ],
        "b": [
            "A",
            "B",
            "C"
        ]
    }
    

### JSON数据解码


```python
import json

# 准备数据
json_obj = r'{"name": "tony", "age": 30, "sex": true, "a": [1, 3], "b": ["A", "B", "C"]}'
#json_obj = "{'name': 'tony', 'age': 30, 'sex': true, 'a': [1, 3], 'b': ['A', 'B', 'C']}"

py_dict = json.loads(json_obj)
print(type(py_dict))  # <class 'dict'>
print(py_dict['name'])
print(py_dict['age'])
print(py_dict['sex'])

py_lista = py_dict['a']  # 取出列表对象
print(py_lista)
py_listb = py_dict['b']  # 取出列表对象
print(py_listb)

# 读取JSON数据到data2.json文件
with open('data2/data2.json', 'r') as f:
    data = json.load(f)
    print(data)
    print(type(data))  # <class 'dict'>
```

    <class 'dict'>
    tony
    30
    True
    [1, 3]
    ['A', 'B', 'C']
    {'name': 'tony', 'age': 30, 'sex': True, 'a': [1, 3], 'b': ['A', 'B', 'C']}
    <class 'dict'>
    

## 配置文件
### 配置文件结构
### 读取配置文件


```python
import configparser

config = configparser.ConfigParser()  # 创建配置解析器对象

config.read('data3/Setup.ini', encoding='utf-8')  # 读取并解析配置文件

print(config.sections())  # 返回所有的节

section1 = config['Startup']  # 返回Startup节
print(config.options('Startup'))

print(section1['RequireOS'])
print(section1['RequireIE'])

print(config['Product']['msi'])

print(config['Windows 2000']['MajorVersion'])  # 返回MajorVersion数据
print(config['Windows 2000']['ServicePackMajor'])

value = config.get('Windows 2000', 'MajorVersion')  # 返回MajorVersion数据
print(type(value))  # <class 'str'>

value = config.getint('Windows 2000', 'MajorVersion')  # 返回MajorVersion数据
print(type(value))  # <class 'int'>
```

    ['Startup', 'Product', 'Windows 2000']
    ['requireos', 'requiremsi', 'requireie']
    Windows 2000
    6.0.2600.0
    AcroRead.msi
    5
    4
    <class 'str'>
    <class 'int'>
    

### 写入配置文件


```python
import configparser

config = configparser.ConfigParser()  # 创建配置解析器对象

config.read('data3/Setup.ini', encoding='utf-8')  # 读取并解析配置文件

# 写入配置文件
config['Startup']['RequireMSI'] = '8.0'
config['Product']['RequireMSI'] = '4.0'

config.add_section('Section2')   #添加节
config.set('Section2', 'name', 'Mac')   #添加配置项

with open('data3/Setup.ini', 'w') as fw:
    config.write(fw)
```


```python

```
