# 正则表达式
## 正则表达式字符串
* 普通字符
* 元字符
### 元字符
### 字符转义
### 开始与结束字符


```python
import re

p1 = r'\w+@zhijieketang\.com'
p2 = r'^\w+@zhijieketang\.com$'

text = "Tony's email is tony_guan588@zhijieketang.com."
m = re.search(p1, text)
print(m)  # 匹配
m = re.search(p2, text)
print(m)  # 不匹配

email = 'tony_guan588@zhijieketang.com'
m = re.search(p2, email)
print(m)
```

    <re.Match object; span=(16, 45), match='tony_guan588@zhijieketang.com'>
    None
    <re.Match object; span=(0, 29), match='tony_guan588@zhijieketang.com'>
    

## 字符类
### 定义字符类


```python
import re

p = r'[Jj]ava'
# p = r'Java|java|JAVA'

m = re.search(p, 'I like Java and Python.')
print(m)  # 匹配

m = re.search(p, 'I like JAVA and Python.')
print(m)  # 不匹配

m = re.search(p, 'I like java and Python.')
print(m)  # 匹配
```

    <re.Match object; span=(7, 11), match='Java'>
    None
    <re.Match object; span=(7, 11), match='java'>
    

### 字符类取反


```python
import re

p = r'[^0123456789]'

m = re.search(p, '1000')
print(m)  # 不匹配

m = re.search(p, 'Python 3')
print(m)  # 匹配
```

    None
    <re.Match object; span=(0, 1), match='P'>
    

### 区间


```python
import re

m = re.search(r'[A-Za-z0-9]', 'A10.3')
print(m)  # 匹配

m = re.search(r'[0-25-7]', 'A3489C')
print(m)  # 不匹配
```

    <re.Match object; span=(0, 1), match='A'>
    None
    

### 预定义字符类


```python
import re

# p = r'[^0123456789]'
p = r'\D'

m = re.search(p, '1000')
print(m)  # 不匹配

m = re.search(p, 'Python 3')
print(m)  # 匹配

text = '你们好Hello'
m = re.search(r'\w', text)
print(m)  # 匹配
```

    None
    <re.Match object; span=(0, 1), match='P'>
    <re.Match object; span=(0, 1), match='你'>
    

## 量词
### 量词的使用


```python
import re

m = re.search(r'\d?', '87654321')  # 出现数字一次
print(m)  # 匹配字符'8'

m = re.search(r'\d?', 'ABC')  # 出现数字零次
print(m)  # 匹配字符''

m = re.search(r'\d*', '87654321')  # 出现数字多次
print(m)  # 匹配字符'87654321'

m = re.search(r'\d*', 'ABC')  # 出现数字零次
print(m)  # 匹配字符''

m = re.search(r'\d+', '87654321')  # 出现数字多次
print(m)  # 匹配字符'87654321'

m = re.search(r'\d+', 'ABC')
print(m)  # 不匹配

m = re.search(r'\d{8}', '87654321')  # 出现数字8次
print('8765432', m)  # 匹配字符'87654321'

m = re.search(r'\d{8}', 'ABC')
print(m)  # 不匹配

m = re.search(r'\d{7,8}', '87654321')  # 出现数字8次
print(m)  # 匹配字符'87654321'

m = re.search(r'\d{9,}', '87654321')
print(m)  # 不匹配

```

    <re.Match object; span=(0, 1), match='8'>
    <re.Match object; span=(0, 0), match=''>
    <re.Match object; span=(0, 8), match='87654321'>
    <re.Match object; span=(0, 0), match=''>
    <re.Match object; span=(0, 8), match='87654321'>
    None
    8765432 <re.Match object; span=(0, 8), match='87654321'>
    None
    <re.Match object; span=(0, 8), match='87654321'>
    None
    

### 贪婪量词和懒惰量词


```python
import re

# 使用贪婪量词
m = re.search(r'\d{5,8}', '87654321')  # 出现数字8次
print(m)  # 匹配字符'87654321'

# 使用惰性量词
m = re.search(r'\d{5,8}?', '87654321')  # 出现数字5次
print(m)  # 匹配字符'87654'
```

    <re.Match object; span=(0, 8), match='87654321'>
    <re.Match object; span=(0, 5), match='87654'>
    

## 分组
### 分组的使用


```python
import re

p = r'(121){2}'
m = re.search(p, '121121abcabc')
print(m)  # 匹配
print(m.group())  # 返回匹配字符串
print(m.group(1))  # 获得第一组内容

p = r'(\d{3,4})-(\d{7,8})'
m = re.search(p, '010-87654321')
print(m)  # 匹配
print(m.group())  # 返回匹配字符串
print(m.groups())  # 获得所有组内容
```

    <re.Match object; span=(0, 6), match='121121'>
    121121
    121
    <re.Match object; span=(0, 12), match='010-87654321'>
    010-87654321
    ('010', '87654321')
    

### 分组命名


```python
import re

p = r'(?P<area_code>\d{3,4})-(?P<phone_code>\d{7,8})'
m = re.search(p, '010-87654321')
print(m)  # 匹配
print(m.group())  # 返回匹配字符串
print(m.groups())  # 获得所有组内容

# 通过组编号返回组内容
print(m.group(1))
print(m.group(2))

# 通过组名返回组内容
print(m.group('area_code'))
print(m.group('phone_code'))
```

    <re.Match object; span=(0, 12), match='010-87654321'>
    010-87654321
    ('010', '87654321')
    010
    87654321
    010
    87654321
    

### 反向引用分组


```python
import re

# p = r'<([\w]+)>.*</([\w]+)>'
p = r'<([\w]+)>.*</\1>'  # 使用反向引用

m = re.search(p, '<a>abc</a>')
print(m)  # 匹配

m = re.search(p, '<a>abc</b>')
print(m)  # 不匹配
```

    <re.Match object; span=(0, 10), match='<a>abc</a>'>
    None
    

### 非捕获分组


```python
import re

s = 'img1.jpg,img2.jpg,img3.bmp'

#捕获分组
p = r'\w+(\.jpg)'
mlist = re.findall(p, s)
print(mlist)

#非捕获分组
p = r'\w+(?:\.jpg)'
mlist = re.findall(p, s)
print(mlist)
```

    ['.jpg', '.jpg']
    ['img1.jpg', 'img2.jpg']
    

## re模块
### search（）和match（）函数


```python
import re

p = r'\w+@zhijieketang\.com'

text = "Tony's email is tony_guan588@zhijieketang.com."
m = re.search(p, text)
print(m)  # 匹配

m = re.match(p, text)
print(m)  # 不匹配

email = 'tony_guan588@zhijieketang.com'
m = re.search(p, email)
print(m)  # 匹配

m = re.match(p, email)
print(m)  # 匹配

# match对象几个方法
print('match对象几个方法:')
print(m.group())
print(m.start())
print(m.end())
print(m.span())
```

    <re.Match object; span=(16, 45), match='tony_guan588@zhijieketang.com'>
    None
    <re.Match object; span=(0, 29), match='tony_guan588@zhijieketang.com'>
    <re.Match object; span=(0, 29), match='tony_guan588@zhijieketang.com'>
    match对象几个方法:
    tony_guan588@zhijieketang.com
    0
    29
    (0, 29)
    

### findall()和finditer（）函数


```python
import re

p = r'[Jj]ava'
text = 'I like Java and java.'

match_list = re.findall(p, text)
print(match_list)  # 匹配

match_iter = re.finditer(p, text)
for m in match_iter:
    print(m.group())

```

    ['Java', 'java']
    Java
    java
    

### 字符串分割


```python
import re

p = r'\d+'
text = 'AB12CD34EF'

clist = re.split(p, text)
print(clist)

clist = re.split(p, text, maxsplit=1)
print(clist)

clist = re.split(p, text, maxsplit=2)
print(clist)

```

    ['AB', 'CD', 'EF']
    ['AB', 'CD34EF']
    ['AB', 'CD', 'EF']
    

### 字符串替换


```python
import re

p = r'\d+'
text = 'AB12CD34EF'

repace_text = re.sub(p, ' ', text)
print(repace_text)

repace_text = re.sub(p, ' ', text, count=1)
print(repace_text)

repace_text = re.sub(p, ' ', text, count=2)
print(repace_text)

```

    AB CD EF
    AB CD34EF
    AB CD EF
    

## 编译正则表达式
re.compile(pattern[,flags=0])
### 已编译正则表达式对象


```python
import re

p = r'\w+@zhijieketang\.com'
regex = re.compile(p)

text = "Tony's email is tony_guan588@zhijieketang.com."
m = regex.search(text)
print(m)  # 匹配

m = regex.match(text)
print(m)  # 不匹配

p = r'[Jj]ava'
regex = re.compile(p)
text = 'I like Java and java.'

match_list = regex.findall(text)
print(match_list)  # 匹配

match_iter = regex.finditer(text)
for m in match_iter:
    print(m.group())

p = r'\d+'
regex = re.compile(p)
text = 'AB12CD34EF'

clist = regex.split(text)
print(clist)

repace_text = regex.sub(' ', text)
print(repace_text)
```

    <re.Match object; span=(16, 45), match='tony_guan588@zhijieketang.com'>
    None
    ['Java', 'java']
    Java
    java
    ['AB', 'CD', 'EF']
    AB CD EF
    

### 编译标志
#### ASCII和Unicode


```python
import re

text = '你们好Hello'

p = r'\w+'
regex = re.compile(p, re.U)

m = regex.search(text)
print(m)  # 匹配

m = regex.match(text)
print(m)  # 匹配

regex = re.compile(p, re.A)

m = regex.search(text)
print(m)  # 匹配

m = regex.match(text)
print(m)  # 不匹配
```

    <re.Match object; span=(0, 8), match='你们好Hello'>
    <re.Match object; span=(0, 8), match='你们好Hello'>
    <re.Match object; span=(3, 8), match='Hello'>
    None
    

#### 忽略大小写


```python
import re

p = r'(java).*(python)'
regex = re.compile(p, re.I)

m = regex.search('I like Java and Python.')
print(m)  # 匹配

m = regex.search('I like JAVA and Python.')
print(m)  # 匹配

m = regex.search('I like java and Python.')
print(m)  # 匹配
```

    <re.Match object; span=(7, 22), match='Java and Python'>
    <re.Match object; span=(7, 22), match='JAVA and Python'>
    <re.Match object; span=(7, 22), match='java and Python'>
    

#### 点元字符匹配换行符


```python
import re

p = r'.+'
regex = re.compile(p)

m = regex.search('Hello\nWorld.')
print(m)  # 匹配

regex = re.compile(p, re.DOTALL)

m = regex.search('Hello\nWorld.')
print(m)  # 匹配
```

    <re.Match object; span=(0, 5), match='Hello'>
    <re.Match object; span=(0, 12), match='Hello\nWorld.'>
    

#### 多行模式


```python
import re

p = r'^World'
regex = re.compile(p)

m = regex.search('Hello\nWorld.')
print(m)  # 不匹配

regex = re.compile(p, re.M)

m = regex.search('Hello\nWorld.')
print(m)  # 匹配
```

    None
    <re.Match object; span=(6, 11), match='World'>
    

#### 详细模式


```python
import re

p = """(java)     #匹配java字符串
        .*        #匹配任意字符零或多个
        (python)  #匹配python字符串
    """

regex = re.compile(p, re.I | re.VERBOSE)

m = regex.search('I like Java and Python.')
print(m)  # 匹配

m = regex.search('I like JAVA and Python.')
print(m)  # 匹配

m = regex.search('I like java and Python.')
print(m)  # 匹配
```

    <re.Match object; span=(7, 22), match='Java and Python'>
    <re.Match object; span=(7, 22), match='JAVA and Python'>
    <re.Match object; span=(7, 22), match='java and Python'>
    


```python

```
